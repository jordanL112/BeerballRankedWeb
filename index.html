<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Beerball Leaderboard</title>

<style>
body {
  background:#0f0f0f;
  color:white;
  font-family:Arial, sans-serif;
  margin:20px;
}

/* ---------- NAV ---------- */
nav {
  display:flex;
  justify-content:center;
  gap:15px;
  margin-bottom:20px;
}
.nav-button {
  padding:10px 20px;
  background:#444;
  border:none;
  color:white;
  cursor:pointer;
}
.nav-button:hover { background:#666; }

.section { display:none; }

/* ---------- TABLE ---------- */
table {
  width:100%;
  border-collapse:collapse;
}
th, td {
  padding:10px;
  border-bottom:1px solid #333;
  text-align:center;
}
th {
  position:sticky;
  top:0;
  background:#000;
}
tr:hover { background:#222; }

.rank-icon {
  width:40px;
  height:40px;
}

/* ---------- FLASHING ---------- */
.flash-name {
  animation: namePulse 0.6s infinite;
}

.flash-group {
  animation: groupPulse 0.7s infinite;
}

@keyframes namePulse {
  0%   { font-weight:normal; }
  50%  { font-weight:bold; }
  100% { font-weight:normal; }
}

@keyframes groupPulse {
  0%   { font-weight:normal; }
  50%  { font-weight:bold; }
  100% { font-weight:normal; }
}
</style>
</head>

<body>

<h1>üç∫ Beerball Leaderboard</h1>

<nav>
  <button class="nav-button" onclick="showSection('leaderboard')">Leaderboard</button>
</nav>

<div id="leaderboard" class="section">
<table>
<thead>
<tr>
  <th>Rank</th>
  <th></th>
  <th>Name</th>
  <th>Tier</th>
  <th>ELO</th>
  <th>Games</th>
  <th>W</th>
  <th>L</th>
  <th>Win %</th>
  <th>Team</th>
  <th>Clan</th>
</tr>
</thead>
<tbody id="board"></tbody>
</table>
</div>

<script>
/* ---------- SECTION SWITCH ---------- */
function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.style.display='none');
  document.getElementById(id).style.display='block';
}

/* ---------- TIER ICON ---------- */
function tierIcon(tier) {
  if (tier.startsWith("Godly")) return "icons/godly.png";
  if (tier.startsWith("Master")) return "icons/master.png";
  if (tier.startsWith("Diamond")) return "icons/diamond.png";
  if (tier.startsWith("Platinum")) return "icons/platinum.png";
  if (tier.startsWith("Gold")) return "icons/gold.png";
  if (tier.startsWith("Silver")) return "icons/silver.png";
  return "icons/bronze.png";
}

/* ---------- TIER COLOR (MATCH MATLAB) ---------- */
function tierColor(tier, flip=false) {
  switch(tier) {
    case "Godly":
      return flip ? "#00b3ff" : "#9c8a19";  // blue / dark gold
    case "Master":
      return "#660099";
    case "Diamond I":
    case "Diamond II":
    case "Diamond III":
      return "#003399";
    case "Silver I":
    case "Silver II":
    case "Silver III":
      return "#c0c0c0";
    case "Bronze I":
    case "Bronze II":
    case "Bronze III":
      return "#663300";
    default:
      return "#ffffff";
  }
}

/* ---------- APPLY NAME FLASH ---------- */
function applyNameFlash(el, tier) {
  let flip = false;
  el.classList.add("flash-name");

  setInterval(() => {
    el.style.color = tierColor(tier, flip);
    flip = !flip;
  }, 600);

  el.style.color = "#ffffff";
}

/* ---------- APPLY TEAM / CLAN FLASH ---------- */
function applyGroupFlash(el, color) {
  el.classList.add("flash-group");
  el.style.setProperty("--group-color", color);

  let on = false;
  setInterval(() => {
    el.style.color = on ? color : "#ffffff";
    on = !on;
  }, 700);
}

/* ---------- LOAD LEADERBOARD ---------- */
fetch("leaderboard.json")
.then(r => r.json())
.then(data => {
  const tbody = document.getElementById("board");

  data.forEach(p => {
    const winPct = p.games > 0 ? ((p.wins/p.games)*100).toFixed(1)+"%" : "0.0%";

    const tr = document.createElement("tr");

    /* ---------- NAME ---------- */
    const nameSpan = document.createElement("span");
    nameSpan.textContent = p.name;
    nameSpan.style.color = "#ffffff";

    if (p.hasFlash === true) {
      applyNameFlash(nameSpan, p.tier);
    }

    /* ---------- TEAM ---------- */
    const teamSpan = document.createElement("span");
    teamSpan.textContent = p.team || "";
    teamSpan.style.color = "#ffffff";

    if (p.teamColor && p.teamColor !== "#000000") {
      applyGroupFlash(teamSpan, p.teamColor);
    }

    /* ---------- CLAN ---------- */
    const clanSpan = document.createElement("span");
    clanSpan.textContent = p.clan || "";
    clanSpan.style.color = "#ffffff";

    if (p.clanColor && p.clanColor !== "#000000") {
      applyGroupFlash(clanSpan, p.clanColor);
    }

    tr.innerHTML = `
      <td>${p.rank}</td>
      <td><img class="rank-icon" src="${tierIcon(p.tier)}"></td>
      <td></td>
      <td>${p.tier}</td>
      <td>${p.elo}</td>
      <td>${p.games}</td>
      <td>${p.wins}</td>
      <td>${p.losses}</td>
      <td>${winPct}</td>
      <td></td>
      <td></td>
    `;

    tr.children[2].appendChild(nameSpan);
    tr.children[9].appendChild(teamSpan);
    tr.children[10].appendChild(clanSpan);

    tbody.appendChild(tr);
  });
});

showSection('leaderboard');
</script>

</body>
</html>
